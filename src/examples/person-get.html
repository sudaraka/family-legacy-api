<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Family Legacy API - Get Person Example</title>
</head>
<body>
    <h1>Get Existing Person (user)</h1>

    <!-- Input form - start -->
    <fieldset>
        <legend>User ID</legend>

        <input type="text" id="id_input">
        <button type="button" id="btn_get">Get Person</button>
    </fieldset>
    <!-- Input form - end -->

    <textarea id="result" cols="80" rows="24" readonly></textarea>

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

<script>

var API_BASE = 'http://api.ourfamilylegacy.org/';  // Base URL for the API resources

// Capture button click event of the form, Make HTTP GET request to get the
// Person record
$('#btn_get').on('click', function() {  // Button click event
    var person_url = API_BASE + 'persons/' + $('#id_input').val();

    $.ajax({
        url: person_url,  // http://api.ourfamilylegacy.org/persons/<id>
        method: 'GET'  // Do a HTTP GET to fetch record
    })
    .done(function(result) {
        // API call returned successfully (HTTP 200)
        // At this point API will return the JSON object of the requested
        // person in response body

        console.log('Name:', result.first_name + ' ' + result.last_name);
        console.log('Email:', result.email);
        console.log('Status:', result.status);
        console.log('Avatar:', result.avatar);
        console.log('Self Url:', result._links.self);

        $('#result').text(JSON.stringify(result));
    })
    .fail(function(xhr) {
        // API call returned a failed status

        if(xhr.responseJSON) {
            // Errors handled or generated by API system is returned as a JSON
            //object

            // Summary message
            console.warn('Error:', xhr.responseJSON.error);

            // Details of the error
            console.log('Message:', xhr.responseJSON.message);

            $('#result').text(JSON.stringify(xhr.responseJSON));
        }
        else {
            // Errors handled or generated *out side* the API system is
            // returned as a standard HTTP (HTML or plain text) response

            $('#result').text(JSON.stringify(xhr.responseText));
        }
    })

});

</script>

</body>
</html>
